{
  "name": "Social Media Multi-Platform Posting Automation",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "triggerOn": "specificFolder",
        "folderToWatch": {
          "__rl": true,
          "value": "1ZyiAYnPcOQKqo3mqvg5KgO_raOdKgc9D",
          "mode": "list",
          "cachedResultName": "Social Media Multi-Platform Automation",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1ZyiAYnPcOQKqo3mqvg5KgO_raOdKgc9D"
        },
        "event": "fileCreated",
        "options": {}
      },
      "id": "a8cac289-6a22-4153-bdd0-1c9c584b68d5",
      "name": "Google Drive Trigger",
      "type": "n8n-nodes-base.googleDriveTrigger",
      "typeVersion": 1,
      "position": [
        -1808,
        4112
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "8oIWIqViNywJuFgw",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "id": "8d1f6aa1-84d6-496c-b394-5ae46a6bc197",
      "name": "Download File",
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        -1584,
        4112
      ],
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "8oIWIqViNywJuFgw",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "fields": {
          "values": [
            {
              "name": "file_url",
              "stringValue": "={{ $('Google Drive Trigger').item.json.webViewLink }}"
            },
            {
              "name": "file_name",
              "stringValue": "={{ $('Download File').item.json.name }}"
            },
            {
              "name": "campaign_name",
              "stringValue": "={{ $('Download File').item.json.name.replace(/\\.[^/.]+$/, '') }}"
            },
            {
              "name": "brand_voice",
              "stringValue": "Professional and engaging"
            }
          ]
        },
        "options": {}
      },
      "id": "429a921e-c5da-4f7d-999d-014f6f2b33fa",
      "name": "Extract File Data",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3,
      "position": [
        -1136,
        4112
      ]
    },
    {
      "parameters": {
        "jsCode": "// Parse Analysis - Combine Image Analysis with File Data\ntry {\n  // Get the analysis from Image Analysis node (from workflow history)\n  const imageAnalysisData = $('Image Analysis').first().json;\n  \n  let analysisText = '';\n  \n  // Handle different possible response structures\n  if (imageAnalysisData.candidates && imageAnalysisData.candidates[0]) {\n    analysisText = imageAnalysisData.candidates[0].content.parts[0].text;\n  } else if (imageAnalysisData.text) {\n    analysisText = imageAnalysisData.text;\n  } else if (typeof imageAnalysisData === 'string') {\n    analysisText = imageAnalysisData;\n  } else {\n    throw new Error('Could not find analysis text in response');\n  }\n  \n  // Clean and parse the JSON from the analysis text\n  const cleanedText = analysisText.replace(/```json\\n?/g, '').replace(/```/g, '').trim();\n  const analysis = JSON.parse(cleanedText);\n  \n  // Get file data from current input (Extract File Data node)\n  const fileData = $input.item.json;\n  \n  // Get binary data from current input\n  const binaryData = $input.item.binary;\n  \n  // Combine everything\n  return {\n    json: {\n      image_analysis: analysis,\n      file_url: fileData.file_url,\n      file_name: fileData.file_name,\n      campaign_name: fileData.campaign_name,\n      brand_voice: fileData.brand_voice\n    },\n    binary: binaryData\n  };\n  \n} catch (error) {\n  // Return detailed error information\n  return {\n    json: {\n      error: error.message,\n      stack: error.stack,\n      image_analysis_raw: $('Image Analysis').first().json,\n      current_input: $input.item.json\n    }\n  };\n}"
      },
      "id": "c7b0bae7-fe2d-4dbd-9c32-c2c0dbfd536a",
      "name": "Parse Analysis",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -912,
        4112
      ]
    },
    {
      "parameters": {
        "jsCode": "// 1. Get the raw input\nconst response = $input.item.json;\n\n// 2. FIX: Drill down to the actual text location (Gemini 2.5 structure)\n// It is nested inside: candidates -> content -> parts -> text\nconst content = response.candidates?.[0]?.content?.parts?.[0]?.text || response.text || '';\n\ntry {\n  // 3. Clean the markdown (remove ```json wrappers)\n  const cleanContent = content.replace(/```json\\n?/g, '').replace(/```/g, '').trim();\n  \n  // 4. Parse the Strategy JSON\n  const strategy = JSON.parse(cleanContent);\n  \n  // 5. Retrieve data from the PREVIOUS code node (\"Parse Analysis\")\n  // We use optional chaining (?.) to prevent crashes if data is missing\n  const prevNode = $('Parse Analysis')?.item?.json || {};\n  const prevBinary = $('Parse Analysis')?.item?.binary || {};\n\n  return {\n    json: {\n      master_strategy: strategy,\n      // Pass along the old data so we don't lose it\n      image_analysis: prevNode.image_analysis,\n      file_url: prevNode.file_url,\n      file_name: prevNode.file_name,\n      campaign_name: prevNode.campaign_name\n    },\n    // Pass the image binary through (needed for posting later)\n    binary: prevBinary.data ? { data: prevBinary.data } : {}\n  };\n\n} catch (error) {\n  return {\n    json: {\n      error: 'Failed to parse master strategy',\n      message: error.message,\n      raw_response: content // This will show you exactly what text (if any) was found\n    }\n  };\n}"
      },
      "id": "db42004a-405f-482b-8e6c-896825231ccd",
      "name": "Parse Strategy",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -336,
        4112
      ]
    },
    {
      "parameters": {
        "jsCode": "// 1. Get all inputs from the Merge Node\nconst items = $input.all();\n\n// 2. Safely get data from the 'Parse Strategy' node\n// We use try/catch or defaults to prevent crashing if the node name changed\nlet strategyData = {};\nlet binaryData = {};\n\ntry {\n  const strategyNode = $('Parse Strategy').first();\n  strategyData = strategyNode.json || {};\n  binaryData = strategyNode.binary || {};\n} catch (error) {\n  // If 'Parse Strategy' isn't found, we'll try to use existing data or defaults\n  strategyData = { campaign_name: 'Unknown', file_name: 'Unknown' };\n}\n\n// 3. Helper: Clean Markdown & Parse JSON\nfunction cleanAndParse(text) {\n  if (!text) return { error: 'Empty response' };\n  try {\n    // Removes ```json, ```, and whitespace\n    const cleaned = text.replace(/```json\\n?/g, '').replace(/```/g, '').trim();\n    return JSON.parse(cleaned);\n  } catch (error) {\n    return { error: 'JSON Parse Failed', raw_text: text };\n  }\n}\n\n// 4. Helper: Extract Content safely from Gemini structure\nfunction extractContent(item) {\n  // Check if item exists and has the deep Gemini structure\n  const text = item?.json?.candidates?.[0]?.content?.parts?.[0]?.text;\n  \n  if (text) {\n    return cleanAndParse(text);\n  }\n  \n  // Fallback: Check if it's in a simpler 'text' field or 'message' field\n  const altText = item?.json?.text || item?.json?.message;\n  if (altText) {\n    return cleanAndParse(altText);\n  }\n\n  return { error: 'No content found in AI response' };\n}\n\n// 5. Map inputs to platforms\n// CRITICAL: Ensure your Merge Node inputs are connected in this EXACT order!\nconst platforms = {\n  facebook: extractContent(items[0]),       // Input 1\n  instagram: extractContent(items[1]),      // Input 2\n  threads: extractContent(items[2]),        // Input 3\n  twitter: extractContent(items[3]),        // Input 4\n  linkedin: extractContent(items[4]),       // Input 5\n  pinterest: extractContent(items[5]),      // Input 6\n  google_business: extractContent(items[6]) // Input 7\n};\n\n// 6. Construct Final Object\nconst aggregatedContent = {\n  campaign_id: strategyData.campaign_name || 'N/A',\n  file_url: strategyData.file_url || '',\n  file_name: strategyData.file_name || '',\n  timestamp: new Date().toISOString(),\n  master_strategy: strategyData.master_strategy || {},\n  platforms: platforms,\n  status: 'pending_approval'\n};\n\n// 7. Return with Binary (Pass-through)\nreturn { \n  json: aggregatedContent,\n  binary: binaryData\n};"
      },
      "id": "c4c6c3f1-1708-4fad-a78a-5199a14d0041",
      "name": "Aggregate All Content",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        464,
        4112
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.facebook.com/v18.0/YOUR_INSTAGRAM_ACCOUNT_ID/media",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_token",
              "value": "YOUR_INSTAGRAM_ACCESS_TOKEN"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"image_url\": \"{{ $json.file_url }}\",\n  \"caption\": \"{{ $json.platforms.instagram.caption }}\\n\\n.\\n.\\n.\\n\\n{{ $json.platforms.instagram.hashtags.join(' ') }}\"\n}",
        "options": {}
      },
      "id": "ab6632be-f896-455b-a11d-ad7f8980ed1d",
      "name": "Post to Instagram",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1456,
        4272
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.pinterest.com/v5/pins",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "pinterestOAuth2Api",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"board_id\": \"YOUR_BOARD_ID_HERE\",\n  \"title\": \"={{ $json.platforms.pinterest.title }}\",\n  \"description\": \"={{ $json.platforms.pinterest.description }}\",\n  \"media_source\": {\n    \"source_type\": \"image_url\",\n    \"url\": \"={{ $('Google Drive Trigger').first().json.webViewLink }}\"\n  }\n}",
        "options": {}
      },
      "id": "23572ebb-4490-4133-be6f-1a00080d1362",
      "name": "Post to Pinterest",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1456,
        5056
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://mybusinessbusinessinformation.googleapis.com/v1/YOUR_ACCOUNT_NAME/locations/YOUR_LOCATION_ID/localPosts",
        "authentication": "genericCredentialType",
        "genericAuthType": "oAuth2Api",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"topicType\": \"STANDARD\",\n  \"summary\": \"{{ $json.platforms.google_business.description }}\",\n  \"media\": [\n    {\n      \"mediaFormat\": \"PHOTO\",\n      \"sourceUrl\": \"{{ $json.file_url }}\"\n    }\n  ],\n  \"callToAction\": {\n    \"actionType\": \"LEARN_MORE\",\n    \"url\": \"https://yourwebsite.com\"\n  }\n}",
        "options": {}
      },
      "id": "3057c711-6986-48a9-80fd-a5c28a7edef7",
      "name": "Post to Google Business",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1456,
        5264
      ]
    },
    {
      "parameters": {
        "resource": "image",
        "operation": "analyze",
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "text": "=You are an expert visual content analyzer for social media marketing. Analyze the provided creative image and extract key information that will be used to generate social media posts.\n\nProvide your analysis in the following JSON structure. IMPORTANT: Return ONLY valid JSON with no markdown formatting, no code blocks, no preamble, no explanation - just pure JSON:\n\n{\n  \"visual_elements\": {\n    \"primary_subject\": \"description of the main focus or subject in the image\",\n    \"colors\": [\"list\", \"of\", \"dominant\", \"colors\"],\n    \"mood\": \"emotional tone of the image (e.g., energetic, calm, professional, playful)\",\n    \"text_in_image\": \"any text visible in the image, write NONE if no text\",\n    \"composition\": \"description of the layout and visual composition\"\n  },\n  \"marketing_elements\": {\n    \"product_service\": \"what product or service is being promoted\",\n    \"key_message\": \"the main marketing message conveyed\",\n    \"call_to_action\": \"any call-to-action visible or implied, write NONE if none\",\n    \"target_audience\": \"inferred target audience based on visual style\"\n  },\n  \"content_opportunities\": {\n    \"storytelling_angles\": [\"angle 1\", \"angle 2\", \"angle 3\"],\n    \"emotional_hooks\": [\"hook 1\", \"hook 2\"],\n    \"engagement_triggers\": [\"trigger 1\", \"trigger 2\"]\n  },\n  \"content_warnings\": {\n    \"sensitive_content\": false,\n    \"requires_disclaimers\": false,\n    \"platform_restrictions\": []\n  }\n}\n\nBe thorough and marketing-focused in your analysis. Remember: Return ONLY the JSON object, nothing else.",
        "inputType": "binary",
        "simplify": false,
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -1360,
        4112
      ],
      "id": "b569f595-e583-47ed-b589-c5e44be094d9",
      "name": "Image Analysis",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are a senior social media strategist creating a comprehensive content strategy for a multi-platform campaign.\n\nBased on the creative analysis provided below, generate a master content strategy that will guide platform-specific content creation.\n\nINPUT CONTEXT:\n- Creative Analysis: {{ JSON.stringify($json.image_analysis) }}\n- Campaign Name: {{ $json.campaign_name }}\n- Brand Voice: {{ $json.brand_voice }}\n\nOUTPUT REQUIREMENTS:\nProvide a JSON structure with the following format. IMPORTANT: Return ONLY valid JSON with no markdown formatting, no code blocks, no preamble - just pure JSON:\n\n{\n  \"core_message\": \"The single most important message to communicate in one clear sentence\",\n  \"value_proposition\": \"Why should audiences care? What's in it for them? Be specific and compelling.\",\n  \"key_themes\": [\"theme1\", \"theme2\", \"theme3\"],\n  \"storytelling_framework\": {\n    \"hook\": \"An attention-grabbing opening line or concept\",\n    \"body\": \"The main content delivery approach\",\n    \"cta\": \"A specific, actionable call-to-action\"\n  },\n  \"hashtag_strategy\": {\n    \"branded\": [\"#BrandHashtag1\", \"#BrandHashtag2\"],\n    \"trending\": [\"#TrendingHashtag1\", \"#TrendingHashtag2\"],\n    \"niche\": [\"#NicheHashtag1\", \"#NicheHashtag2\"]\n  },\n  \"tone_guidance\": {\n    \"emotional_tone\": \"Choose: inspirational, humorous, urgent, educational, informative, or empowering\",\n    \"language_style\": \"Choose: conversational, professional, casual, or authoritative\",\n    \"personality_traits\": [\"authentic\", \"helpful\", \"energetic\"]\n  },\n  \"engagement_tactics\": [\"tactic1 to drive engagement\", \"tactic2 to drive engagement\", \"tactic3 to drive engagement\"]\n}\n\nCreate a cohesive strategy that can be adapted for each social media platform while maintaining brand consistency across all channels. Remember: Return ONLY the JSON object, nothing else.",
          "maxOutputTokens": 4096,
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -688,
        4112
      ],
      "id": "93fcc4ac-ef15-4341-971a-6163022805bd",
      "name": "Master Strategy",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert Facebook content creator specializing in high-engagement posts.\n\nPLATFORM REQUIREMENTS:\n- Character limit: 63,206 characters (but optimal is 40-80 characters for initial hook)\n- Image posts perform better with shorter captions\n- First 2-3 lines are visible without 'See More' - make them count\n- Emojis are encouraged but don't overuse\n- Hashtags work but are less critical than other platforms (3-5 max)\n\nFACEBOOK BEST PRACTICES:\n- Start with a hook that stops scrolling\n- Use line breaks for readability (2-3 lines max per paragraph)\n- Ask questions to drive comments\n- Include clear CTA (call-to-action)\n- Storytelling format works very well\n\nCONTENT TO AVOID:\n- Engagement bait ('Like if you agree', 'Tag a friend')\n- Sensationalized clickbait\n- Too many hashtags (looks spammy)\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate a Facebook post with the following JSON structure:\n\n{\n  \"post_text\": \"The complete post copy with line breaks\",\n  \"first_comment\": \"Optional engaging first comment to seed discussion\",\n  \"hashtags\": [\"#hashtag1\", \"#hashtag2\"],\n  \"cta_type\": \"learn_more/shop_now/sign_up/no_cta\"\n}\n\nMake it authentic, engaging, and scroll-stopping. \n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        3632
      ],
      "id": "26b71174-27fa-457d-953e-17adf2ff679d",
      "name": "AI: Facebook Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert Pinterest content creator who understands visual search and discovery.\n\nPLATFORM REQUIREMENTS:\n- Title: 100 characters max\n- Description: 500 characters max (but 150-200 optimal)\n- Hashtags: 3-5 max\n- Vertical images perform best\n\nPINTEREST BEST PRACTICES:\n- Front-load keywords in title and description\n- Describe what users will GET from clicking\n- Use natural language, not keyword stuffing\n- Include benefits and outcomes\n- 'How to' content performs exceptionally\n\nSEARCH OPTIMIZATION:\n- Use long-tail keywords naturally\n- Include action words (learn, discover, get, find)\n- Category-specific terminology\n\nCONTENT TYPES THAT WORK:\n- DIY and tutorials\n- Inspiration and ideas\n- Product showcases with benefits\n- Before/after transformations\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate Pinterest pin content with this JSON structure:\n\n{\n  \"title\": \"SEO-optimized title (max 100 chars)\",\n  \"description\": \"Keyword-rich description (150-200 chars)\",\n  \"board_suggestion\": \"Suggested board name/category\",\n  \"keywords\": [\"keyword1\", \"keyword2\", \"keyword3\"],\n  \"hashtags\": [\"#hashtag1\", \"#hashtag2\"]\n}\n\nMake it searchable, descriptive, and value-focused.\n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        4640
      ],
      "id": "3645e9f5-c276-4f2a-a098-fb555e75f2c7",
      "name": "AI: Pinterest Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert local business marketer creating Google Business Profile posts.\n\nPLATFORM REQUIREMENTS:\n- Text limit: 1,500 characters\n- Optimal length: 150-300 characters\n- Posts expire after 7 days\n- Can include: What's New, Events, Offers, Products\n\nGOOGLE BUSINESS BEST PRACTICES:\n- Lead with the most important information\n- Include specific details (dates, times, prices)\n- Use clear, action-oriented language\n- Local keywords help discovery\n- Include CTA buttons\n\nPOST TYPES:\n1. What's New: Updates, announcements\n2. Event: Time-bound happenings\n3. Offer: Special promotions\n4. Product: Showcase items/services\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate Google Business Profile post with this JSON structure:\n\n{\n  \"post_type\": \"whats_new/event/offer/product\",\n  \"description\": \"Main post content (150-300 chars optimal)\",\n  \"cta_type\": \"book/order/buy/learn_more/sign_up/call\",\n  \"keywords\": [\"local keyword1\", \"local keyword2\"]\n}\n\nMake it local-focused, action-oriented, and specific.\n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        4832
      ],
      "id": "a68bfdfe-8454-448c-a681-87cfa63b9d10",
      "name": "AI: Google Business Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert Instagram content creator focused on aesthetic and engaging feed posts.\n\nPLATFORM REQUIREMENTS:\n- Caption limit: 2,200 characters\n- First 125 characters visible without 'more' click\n- Hashtags: 3-30 (optimal 9-11, mix of sizes)\n- Emojis highly encouraged for personality\n\nINSTAGRAM BEST PRACTICES:\n- Front-load value in first line (before 'more')\n- Use line breaks with spacing for readability\n- Strategic hashtag placement\n- Strong CTA in caption\n- Authentic storytelling beats sales-y copy\n\nCAPTION STYLES THAT WORK:\n- Storytelling with personal touch\n- Educational value in bite-sized tips\n- Behind-the-scenes authenticity\n- Question-based to drive engagement\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate Instagram feed post content with this JSON structure:\n\n{\n  \"caption\": \"Complete caption with emojis and line breaks\",\n  \"hook_line\": \"The first 125 characters that show before 'more'\",\n  \"hashtags\": [\"#hashtag1\", \"#hashtag2\", \"#hashtag3\", \"#hashtag4\", \"#hashtag5\", \"#hashtag6\", \"#hashtag7\", \"#hashtag8\", \"#hashtag9\"],\n  \"alt_text\": \"Accessibility description of image\",\n  \"cta\": \"clear call to action\"\n}\n\nMake it visually appealing, authentic, and engagement-focused. \n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        3824
      ],
      "id": "1fd35401-7892-4c2e-bfb8-3834c530b4ab",
      "name": "AI: Instagram Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert Twitter/X content creator who understands viral mechanics and platform culture.\n\nPLATFORM REQUIREMENTS:\n- Character limit: 280 characters (4,000 for X Premium)\n- Optimal engagement: 71-100 characters\n- Hashtags: 1-2 max (overuse kills engagement)\n\nTWITTER BEST PRACTICES:\n- Start strong - first few words determine if people read more\n- One clear idea per tweet\n- Conversations over broadcasts\n- Humor and wit perform exceptionally well\n- Questions and polls boost interaction\n\nCONTENT STYLES THAT WORK:\n- Thread format (1/) for depth\n- 'Unpopular opinion:' posts\n- Quick tips with value\n- Personal stories with lessons\n\nCONTENT TO AVOID:\n- Too many hashtags (looks desperate)\n- Overly promotional\n- Asking for retweets explicitly\n- Corporate speak (be human)\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate Twitter/X content with this JSON structure:\n\n{\n  \"tweet_text\": \"The main tweet text (under 280 chars)\",\n  \"thread\": [\"If this should be a thread, provide 2-3 additional tweets\"],\n  \"hashtags\": [\"#hashtag1\"],\n  \"alt_text\": \"Image description for accessibility\"\n}\n\nMake it punchy, valuable, and conversation-starting.\n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        4240
      ],
      "id": "61453e35-ef4e-4629-92c9-482de8c1f175",
      "name": "AI: Twitter Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert LinkedIn content creator who understands professional networking and B2B engagement.\n\nPLATFORM REQUIREMENTS:\n- Character limit: 3,000 characters\n- First 140 characters visible without 'see more'\n- Optimal length: 150-300 words\n- Hashtags: 3-5 relevant professional hashtags\n\nLINKEDIN BEST PRACTICES:\n- Lead with value in first 140 characters\n- Professional but conversational tone\n- Storytelling with business lessons\n- Educational content over promotional\n- Ask thought-provoking questions\n- Line breaks for readability\n\nCONTENT FORMATS THAT WORK:\n- Personal story with professional lesson\n- Industry insights and trends\n- Career advice and tips\n- Thought leadership\n\nCONTENT TO AVOID:\n- Overly salesy posts\n- Humble-bragging without value\n- Too casual/unprofessional tone\n- Clickbait tactics\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate LinkedIn content with this JSON structure:\n\n{\n  \"post_text\": \"Complete post with line breaks and structure\",\n  \"hook\": \"The first 140 characters (must be compelling)\",\n  \"hashtags\": [\"#Hashtag1\", \"#Hashtag2\", \"#Hashtag3\"],\n  \"cta\": \"Call to action (subtle and professional)\"\n}\n\nMake it professional, valuable, and authentically human.\n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        4448
      ],
      "id": "4bb6a804-3d65-44b7-9463-4883f5ab99b4",
      "name": "AI: LinkedIn Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "numberInputs": 7
      },
      "id": "1367c2d5-0eb9-44e6-91be-a1bcee93e616",
      "name": "Wait for All AI Content",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        240,
        4048
      ]
    },
    {
      "parameters": {
        "modelId": {
          "__rl": true,
          "value": "models/gemini-2.5-flash",
          "mode": "list",
          "cachedResultName": "models/gemini-2.5-flash"
        },
        "messages": {
          "values": [
            {}
          ]
        },
        "simplify": false,
        "jsonOutput": true,
        "builtInTools": {},
        "options": {
          "systemMessage": "=You are an expert Threads content creator who understands Instagram's text-based companion platform.\n\nPLATFORM REQUIREMENTS:\n- Character limit: 500 characters\n- Optimal length: 100-280 characters for best engagement\n- Can include up to 10 images (we're using 1)\n- Hashtags: 3-5 max (less spammy than Instagram)\n- Threading: Can create multi-post threads\n- Link sharing: One link per post allowed\n\nTHREADS BEST PRACTICES:\n- Conversational and authentic tone (like Twitter but friendlier)\n- Community-focused, less promotional\n- Quick takes, hot topics, and real-time reactions work well\n- Questions and polls drive high engagement\n- Behind-the-scenes content performs well\n- Less polished than Instagram feed posts\n- Humor and personality shine here\n- First 2-3 lines show in feed before 'See more'\n\nCONTENT STYLES THAT WORK:\n- Thought-starters and opinions\n- Quick tips and insights\n- Relatable observations\n- Industry commentary\n- Personal stories (brief)\n- Questions to spark discussion\n- Hot takes (brand-appropriate)\n- News and trend reactions\n\nCONTENT TO AVOID:\n- Overly long posts (keep it punchy)\n- Too many hashtags (looks desperate)\n- Heavy self-promotion\n- Corporate speak (be human)\n- Reposting exact Instagram captions\n- Link spam\n\nMASTER STRATEGY:\n{{ JSON.stringify($json.master_strategy) }}\n\nCREATIVE ANALYSIS:\n{{ JSON.stringify($json.image_analysis) }}\n\nGenerate Threads content with this JSON structure:\n\n{\n  \"thread_text\": \"The main post text (under 500 chars, ideally 100-280)\",\n  \"thread_continuation\": [\"If needed, add 1-2 follow-up thread posts here\"],\n  \"hashtags\": [\"#hashtag1\", \"#hashtag2\", \"#hashtag3\"],\n  \"tone\": \"conversational/insightful/humorous/authentic\",\n  \"engagement_hook\": \"What makes this post comment-worthy?\"\n}\n\nMake it conversational, authentic, and discussion-worthy. Threads is where your brand's personality shines.\n\nReturn ONLY the JSON, no other text.",
          "temperature": 0.8,
          "topP": 1,
          "topK": 1
        }
      },
      "type": "@n8n/n8n-nodes-langchain.googleGemini",
      "typeVersion": 1.1,
      "position": [
        -112,
        4032
      ],
      "id": "af210ac6-0fc6-4431-abd7-e098841c240b",
      "name": "AI: Threads Content",
      "retryOnFail": true,
      "credentials": {
        "googlePalmApi": {
          "id": "52kXXrTYVhuOOiyQ",
          "name": "Google Gemini(PaLM) Api account 3"
        }
      }
    },
    {
      "parameters": {
        "sendTo": "admin@yourcompany.com",
        "subject": "={{ $json.subject }}",
        "message": "={{ $json.html_message }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.2,
      "position": [
        896,
        4112
      ],
      "id": "31fa8bba-da67-4dd2-a1d2-70d637ef8484",
      "name": "Send a message",
      "webhookId": "6ae4934f-7995-469d-ba61-b703726cd287",
      "credentials": {
        "gmailOAuth2": {
          "id": "n46CSnjSPOQkSwDD",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "resume": "webhook",
        "limitWaitTime": true,
        "resumeAmount": 3,
        "resumeUnit": "days",
        "options": {
          "responseData": "âœ… Approved! The social media posts are being published now."
        }
      },
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1104,
        4112
      ],
      "id": "75797009-1cc1-4d2c-83c2-e056d2e07e0d",
      "name": "Wait",
      "webhookId": "a61e4daf-0ccc-4fe9-a4a3-e507349dd526"
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        992,
        4448
      ],
      "id": "e0c7bddc-095d-44f1-9081-114e29a6a02f",
      "name": "Merge"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.twitter.com/2/tweets",
        "authentication": "predefinedCredentialType",
        "nodeCredentialType": "twitterOAuth2Api",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"text\": \"={{ $json.platforms.twitter.tweet_text }}\"\n}",
        "options": {}
      },
      "id": "a713f4f0-3da2-4003-b4cc-947ba904e3bb",
      "name": "Post to Twitter/X",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1456,
        4864
      ]
    },
    {
      "parameters": {
        "mode": "combine",
        "combineBy": "combineByPosition",
        "numberInputs": 7,
        "options": {}
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1936,
        4384
      ],
      "id": "a2888dc8-0cde-4e75-8223-2e620b7de411",
      "name": "Merge1"
    },
    {
      "parameters": {
        "sendTo": "admin@yourcompany.com",
        "subject": "={{ $json.email_subject }}",
        "message": "={{ $json.email_body }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.2,
      "position": [
        2336,
        4464
      ],
      "id": "19fa5f9e-84e5-4041-9ff3-f949cc3ab00a",
      "name": "Send Completion Notification",
      "webhookId": "68ad5e49-dd21-47e6-a601-a332f795a950",
      "credentials": {
        "gmailOAuth2": {
          "id": "n46CSnjSPOQkSwDD",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// COLLECT POSTING RESULTS & GENERATE REPORT\n// This code safely checks all previous nodes, even if some failed.\n\n// 1. Define the Node Names exactly as they appear in your canvas\n// (Update these names if your nodes are named differently!)\nconst nodes = {\n  facebook: 'Post to Facebook', \n  instagram: 'Post to Instagram',\n  twitter: 'Post to Twitter/X',\n  linkedin: 'Post to LinkedIn',\n  pinterest: 'Post to Pinterest',\n  google_business: 'Post to Google Business',\n  // threads: 'Post to Threads' // Uncomment if you added Threads\n};\n\n// 2. Helper to safely grab data without crashing\nconst getResult = (nodeName, idPath) => {\n  try {\n    // Attempt to find the node's output\n    const item = $(nodeName).first();\n    \n    if (!item || !item.json) return { status: 'skipped', id: null };\n    \n    // Check for success ID based on the path provided\n    // Twitter often puts ID inside \"data\", others use \"id\" or \"name\"\n    const data = item.json;\n    let successId = null;\n\n    if (idPath === 'data.id') successId = data.data?.id;\n    else if (idPath === 'name') successId = data.name;\n    else successId = data.id;\n\n    if (successId) {\n      return { status: 'success', id: successId };\n    } else {\n      // Node ran, but returned an error structure\n      return { status: 'failed', error: JSON.stringify(data).substring(0, 100) };\n    }\n  } catch (error) {\n    // Node likely didn't run or wasn't found\n    return { status: 'failed', error: 'Node execution missing or crashed' };\n  }\n};\n\n// 3. Collect Data\n// We use the ID paths specific to the APIs you are using (HTTP/Native)\nconst results = {\n  campaign_id: $('Aggregate All Content').first().json.campaign_id || 'Unknown',\n  timestamp: new Date().toISOString(),\n  platforms: {\n    facebook: getResult(nodes.facebook, 'id'),\n    instagram: getResult(nodes.instagram, 'id'),     // Graph API returns { id: ... }\n    twitter: getResult(nodes.twitter, 'data.id'),    // Twitter V2 HTTP returns { data: { id: ... } }\n    linkedin: getResult(nodes.linkedin, 'id'),\n    pinterest: getResult(nodes.pinterest, 'id'),\n    google_business: getResult(nodes.google_business, 'name') // GBP returns { name: ... }\n  },\n  summary: {\n    successful: 0,\n    failed: 0,\n    total: 0\n  }\n};\n\n// 4. Calculate Totals\nObject.values(results.platforms).forEach(p => {\n  results.summary.total++;\n  if (p.status === 'success') results.summary.successful++;\n  else results.summary.failed++;\n});\n\n// 5. Generate HTML Email Body for the final notification\nlet emailHtml = `\n<div style=\"font-family: sans-serif; padding: 20px; border: 1px solid #ddd; border-radius: 8px;\">\n  <h2 style=\"color: #2c3e50;\">ğŸš€ Posting Report: ${results.campaign_id}</h2>\n  <p><b>Status:</b> ${results.summary.successful} / ${results.summary.total} Posted Successfully</p>\n  <hr>\n  <ul style=\"list-style: none; padding: 0;\">\n`;\n\nfor (const [platform, data] of Object.entries(results.platforms)) {\n  const icon = data.status === 'success' ? 'âœ…' : 'âŒ';\n  const color = data.status === 'success' ? 'green' : 'red';\n  const details = data.status === 'success' ? `ID: ${data.id}` : `Error: ${data.error || 'Unknown'}`;\n  \n  emailHtml += `\n    <li style=\"margin-bottom: 10px; padding: 10px; background-color: #f9f9f9; border-left: 4px solid ${color};\">\n      <strong style=\"text-transform: uppercase;\">${icon} ${platform}</strong><br>\n      <span style=\"font-size: 12px; color: #555;\">${details}</span>\n    </li>\n  `;\n}\n\nemailHtml += `</ul></div>`;\n\n// 6. Return Data\nreturn {\n  json: {\n    ...results,\n    email_subject: `Posting Report: ${results.summary.successful}/${results.summary.total} Success`,\n    email_body: emailHtml,\n    email_to: $('Aggregate All Content').first().json.email_to || 'your_email@example.com'\n  }\n};"
      },
      "id": "abcfea29-0c78-4a54-a9fe-fac43fee980d",
      "name": "Collect Posting Results",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2144,
        4464
      ]
    },
    {
      "parameters": {
        "httpRequestMethod": "POST",
        "node": "me",
        "edge": "photos",
        "sendBinaryData": true,
        "binaryPropertyName": "={{ $json.file_url }}",
        "options": {
          "queryParameters": {
            "parameter": [
              {
                "name": "message",
                "value": "={{ $json.platforms.facebook.post_text }}"
              }
            ]
          }
        }
      },
      "type": "n8n-nodes-base.facebookGraphApi",
      "typeVersion": 1,
      "position": [
        1456,
        4096
      ],
      "id": "65dbd257-e877-40e7-9aed-83e3e87ecefc",
      "name": "Post to Facebook"
    },
    {
      "parameters": {
        "text": "={{ $json.platforms.linkedin.post_text }}",
        "shareMediaCategory": "IMAGE",
        "additionalFields": {}
      },
      "type": "n8n-nodes-base.linkedIn",
      "typeVersion": 1,
      "position": [
        1456,
        4656
      ],
      "id": "e195396f-b10d-4bbb-ac5b-8386d4bb0a72",
      "name": "Post to LinkedIn"
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.threads.net/v1.0/me/threads",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_token",
              "value": "YOUR_THREADS_ACCESS_TOKEN"
            }
          ]
        },
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n  \"media_type\": \"IMAGE\",\n  \"image_url\": \"{{ $('Google Drive Trigger').first().json.webViewLink }}\",\n  \"text\": \"{{ $json.platforms.threads.thread_text }}\"\n}",
        "options": {}
      },
      "id": "1c8bb79f-a0df-4d24-968e-620b69dedf29",
      "name": "Post to Threads - 1",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1456,
        4464
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.threads.net/v1.0/YOUR_THREADS_USER_ID/threads_publish",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_token",
              "value": "YOUR_THREADS_ACCESS_TOKEN"
            },
            {
              "name": "creation_id",
              "value": "={{ $('Post to Threads - 1').item.json.id }}"
            }
          ]
        },
        "options": {}
      },
      "id": "11e64823-2fc6-4c5f-a100-9a5de582e373",
      "name": "Post to Threads",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1664,
        4464
      ]
    },
    {
      "parameters": {
        "jsCode": "// FORMAT EMAIL CONTENT (HTML BEAUTIFIER + DATA PASS-THROUGH)\nconst content = $input.item.json;\nconst platforms = content.platforms || {};\n\n// 1. Helper to safely get text and convert newlines to HTML breaks\nconst formatText = (text) => {\n    if (!text) return \"<i>âš ï¸ No content generated.</i>\";\n    // Converts \\n to <br> so emails show the spacing\n    return text.replace(/\\n/g, '<br>');\n};\n\n// 2. Get Webhook Links\n// If testing manually, use n8n.io as a placeholder so it doesn't break\nconst approveLink = $execution.resumeUrl || \"https://n8n.io\"; \nconst rejectLink = \"https://google.com\";\n\n// 3. START HTML MESSAGE\nlet html = `\n<div style=\"font-family: Arial, sans-serif; color: #333; max-width: 600px;\">\n  <h2 style=\"color: #2c3e50;\">ğŸ¨ Approval Needed: Social Media Content</h2>\n  <p><b>Campaign:</b> ${content.campaign_id || 'N/A'}<br>\n  <b>File:</b> ${content.file_name || 'N/A'}</p>\n  \n  ${content.file_url ? `<p><b><a href=\"${content.file_url}\" style=\"color: #007bff;\">ğŸ‘ï¸ View Creative Preview</a></b></p>` : ''}\n  \n  <hr style=\"border: 1px solid #eee; margin: 20px 0;\">\n\n  <h3 style=\"color: #3b5998;\">ğŸ“˜ FACEBOOK</h3>\n  <p>${formatText(platforms.facebook?.post_text)}</p>\n  <p style=\"color: #777; font-size: 0.9em;\">${platforms.facebook?.hashtags?.join(' ') || ''}</p>\n  <hr style=\"border: 1px solid #eee;\">\n\n  <h3 style=\"color: #C13584;\">ğŸ“¸ INSTAGRAM</h3>\n  <p>${formatText(platforms.instagram?.caption)}</p>\n  <p style=\"color: #777; font-size: 0.9em;\">${platforms.instagram?.hashtags?.join(' ') || ''}</p>\n  <hr style=\"border: 1px solid #eee;\">\n\n  <h3 style=\"color: #000000;\">ğŸ§µ THREADS</h3>\n  <p>${formatText(platforms.threads?.thread_text)}</p>\n  <hr style=\"border: 1px solid #eee;\">\n\n  <h3 style=\"color: #1DA1F2;\">ğŸ¦ TWITTER / X</h3>\n  <p>${formatText(platforms.twitter?.tweet_text)}</p>\n  <hr style=\"border: 1px solid #eee;\">\n\n  <h3 style=\"color: #0077b5;\">ğŸ’¼ LINKEDIN</h3>\n  <p>${formatText(platforms.linkedin?.post_text)}</p>\n  <hr style=\"border: 1px solid #eee;\">\n\n  <h3 style=\"color: #bd081c;\">ğŸ“Œ PINTEREST</h3>\n  <p><b>Title:</b> ${platforms.pinterest?.title || 'N/A'}</p>\n  <p>${formatText(platforms.pinterest?.description)}</p>\n  <hr style=\"border: 1px solid #eee;\">\n\n  <h3 style=\"color: #4285F4;\">ğŸŒ GOOGLE BUSINESS</h3>\n  <p>${formatText(platforms.google_business?.description)}</p>\n\n  <br><br>\n  \n  <div style=\"background-color: #f9f9f9; padding: 20px; border-radius: 8px; text-align: center;\">\n    <h3>ğŸ‘‡ ACTION REQUIRED ğŸ‘‡</h3>\n    <a href=\"${approveLink}\" style=\"background-color: #28a745; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; font-weight: bold; margin-right: 10px;\">âœ… APPROVE & POST</a>\n    \n    <a href=\"${rejectLink}\" style=\"background-color: #dc3545; color: white; padding: 12px 24px; text-decoration: none; border-radius: 5px; font-weight: bold;\">âŒ REJECT</a>\n  </div>\n</div>\n`;\n\nreturn {\n  json: {\n    ...content, // <--- CRITICAL: This passes all your platform data to the next nodes!\n    subject: `Approval: ${content.campaign_id || 'Content Ready'}`,\n    html_message: html,\n    email_to: \"your_email@example.com\"\n  }\n};"
      },
      "id": "0ea627c0-2b4a-4b95-8b67-741fe85efe92",
      "name": "Format Email Message",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        688,
        4112
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://graph.facebook.com/v18.0/YOUR_INSTAGRAM_ACCOUNT_ID/media_publish",
        "sendQuery": true,
        "queryParameters": {
          "parameters": [
            {
              "name": "access_token",
              "value": "YOUR_INSTAGRAM_ACCESS_TOKEN"
            },
            {
              "name": "creation_id",
              "value": "={{ $json.id }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        1664,
        4272
      ],
      "id": "be9b187a-6d2a-4d49-bad5-d9e84fb07464",
      "name": "Instagram: Publish Container"
    },
    {
      "parameters": {
        "jsCode": "// Get the platform data from the approval\nconst approvalData = $('Aggregate All Content').first().json;\n\n// Get the file URL from Google Drive Trigger\nconst fileUrl = $('Google Drive Trigger').first().json.webViewLink;\nconst fileId = $('Google Drive Trigger').first().json.id;\n\n// Return combined data\nreturn {\n  json: {\n    ...approvalData,\n    file_url: fileUrl,\n    file_id: fileId,\n    platforms: approvalData.platforms\n  }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1200,
        4448
      ],
      "id": "73d1193c-b520-445b-ac97-211cc364d51a",
      "name": "Prepare Data For Posting"
    }
  ],
  "pinData": {},
  "connections": {
    "Google Drive Trigger": {
      "main": [
        [
          {
            "node": "Download File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download File": {
      "main": [
        [
          {
            "node": "Image Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Strategy": {
      "main": [
        [
          {
            "node": "AI: Facebook Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI: Instagram Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI: Twitter Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI: LinkedIn Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI: Pinterest Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI: Google Business Content",
            "type": "main",
            "index": 0
          },
          {
            "node": "AI: Threads Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate All Content": {
      "main": [
        [
          {
            "node": "Format Email Message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post to Instagram": {
      "main": [
        [
          {
            "node": "Instagram: Publish Container",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post to Pinterest": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 5
          }
        ]
      ]
    },
    "Post to Google Business": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 6
          }
        ]
      ]
    },
    "Parse Analysis": {
      "main": [
        [
          {
            "node": "Master Strategy",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Image Analysis": {
      "main": [
        [
          {
            "node": "Extract File Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract File Data": {
      "main": [
        [
          {
            "node": "Parse Analysis",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Master Strategy": {
      "main": [
        [
          {
            "node": "Parse Strategy",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: Facebook Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: Instagram Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "AI: Twitter Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "AI: LinkedIn Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "Wait for All AI Content": {
      "main": [
        [
          {
            "node": "Aggregate All Content",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AI: Threads Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "AI: Pinterest Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 5
          }
        ]
      ]
    },
    "Send a message": {
      "main": [
        [
          {
            "node": "Wait",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Wait": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "Prepare Data For Posting",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post to Twitter/X": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "Merge1": {
      "main": [
        [
          {
            "node": "Collect Posting Results",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Collect Posting Results": {
      "main": [
        [
          {
            "node": "Send Completion Notification",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post to Facebook": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post to LinkedIn": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "Post to Threads - 1": {
      "main": [
        [
          {
            "node": "Post to Threads",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Post to Threads": {
      "main": [
        [
          {
            "node": "Merge1",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "AI: Google Business Content": {
      "main": [
        [
          {
            "node": "Wait for All AI Content",
            "type": "main",
            "index": 6
          }
        ]
      ]
    },
    "Format Email Message": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Data For Posting": {
      "main": [
        [
          {
            "node": "Post to Facebook",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post to LinkedIn",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post to Pinterest",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post to Twitter/X",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post to Google Business",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post to Instagram",
            "type": "main",
            "index": 0
          },
          {
            "node": "Post to Threads - 1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false
  },
  "versionId": "d3a5c880-2f1e-45c1-9c80-22bf05877158",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "650a0a1e8a2bb7cfa17795b732fa24b1a81b03c88e55bb689e7983667dbd47ef"
  },
  "id": "i0HO4QP8NOQLaRKBUVfKU",
  "tags": []
}